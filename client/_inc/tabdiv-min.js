/* Jison generated parser */
var vextab_parser=function(){function n(){this.yy={}}var e={trace:function(){},yy:{},symbols_:{error:2,e:3,maybe_vextab:4,EOF:5,vextab:6,stave:7,voice:8,maybe_options:9,stave_data:10,OPTIONS:11,options:12,TABSTAVE:13,VOICE:14,stave_additions:15,TEXT:16,text:17,NOTES:18,notes:19,WORD:20,"=":21,STR:22,",":23,lingo:24,line:25,chord:26,time:27,bar:28,"[":29,"]":30,tuplets:31,annotations:32,rest:33,"|":34,":":35,frets:36,maybe_decorator:37,"/":38,string:39,chord_line:40,".":41,"(":42,")":43,articulation:44,NUMBER:45,abc:46,timed_fret:47,time_values:48,maybe_dot:49,time_unit:50,maybe_slash:51,w:52,h:53,q:54,d:55,S:56,"-":57,s:58,t:59,T:60,b:61,p:62,v:63,V:64,u:65,"^":66,$:67,annotation_words:68,"#":69,ABC:70,abc_accidental:71,accidental_type:72,"@":73,n:74,"~":75,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",11:"OPTIONS",13:"TABSTAVE",14:"VOICE",16:"TEXT",18:"NOTES",20:"WORD",21:"=",22:"STR",23:",",29:"[",30:"]",34:"|",35:":",38:"/",41:".",42:"(",43:")",45:"NUMBER",52:"w",53:"h",54:"q",55:"d",56:"S",57:"-",58:"s",59:"t",60:"T",61:"b",62:"p",63:"v",64:"V",65:"u",66:"^",67:"$",69:"#",70:"ABC",73:"@",74:"n",75:"~"},productions_:[0,[3,2],[4,0],[4,1],[6,1],[6,2],[7,3],[7,2],[7,2],[8,1],[8,1],[10,1],[10,2],[15,2],[15,2],[9,0],[9,1],[12,3],[12,4],[17,1],[17,3],[19,1],[19,2],[24,1],[24,1],[24,1],[24,1],[24,1],[24,1],[24,1],[24,1],[24,1],[28,1],[28,3],[28,3],[28,3],[28,3],[28,3],[25,4],[40,1],[40,3],[26,4],[26,5],[36,1],[36,1],[36,2],[36,4],[47,5],[47,1],[47,5],[47,1],[27,3],[48,2],[50,1],[50,1],[50,1],[50,1],[49,0],[49,1],[51,0],[51,1],[39,1],[44,1],[44,1],[44,1],[44,1],[44,1],[44,1],[44,1],[37,1],[37,1],[37,1],[37,1],[37,0],[31,3],[31,5],[32,3],[68,1],[68,3],[33,2],[33,3],[33,4],[46,3],[71,1],[71,2],[71,1],[71,2],[71,1],[71,0],[72,0],[72,1]],performAction:function(t,n,r,i,s,o,u){var a=o.length-1;switch(s){case 1:return Vex.Flow.VexTab.DEBUG&&o[a-1]&&(console.log(o[a-1]),console.log(JSON.stringify(o[a-1],null," "))),o[a-1];case 2:this.$=null;break;case 3:this.$=o[a];break;case 4:this.$=[o[a]];break;case 5:this.$=[].concat(o[a-1],o[a]);break;case 6:this.$={element:o[a-2],options:o[a-1],notes:o[a].notes,text:o[a].text,_l:u[a-2].first_line,_c:u[a-2].first_column};break;case 7:this.$={element:o[a-1],options:o[a],_l:u[a-1].first_line,_c:u[a-1].first_column};break;case 8:this.$={element:"options",params:o[a],_l:u[a-1].first_line,_c:u[a-1].first_column};break;case 11:this.$=o[a];break;case 12:var f=[].concat(o[a-1].text,o[a].text),l=[].concat(o[a-1].notes,o[a].notes);this.$={text:f,notes:l};break;case 13:this.$={text:o[a],notes:[]};break;case 14:this.$={notes:o[a],text:[]};break;case 15:this.$=null;break;case 16:this.$=o[a];break;case 17:this.$=[{key:o[a-2],value:o[a],_l:u[a-2].first_line,_c:u[a-2].first_column}];break;case 18:this.$=[].concat(o[a-3],[{key:o[a-2],value:o[a],_l:u[a-2].first_line,_c:u[a-2].first_column}]);break;case 19:this.$=[{text:o[a],_l:u[a].first_line,_c:u[a].first_column}];break;case 20:this.$=[].concat(o[a-2],{text:o[a],_l:u[a].first_line,_c:u[a].first_column});break;case 21:this.$=o[a];break;case 22:this.$=[].concat(o[a-1],o[a]);break;case 23:this.$=o[a];break;case 24:this.$=o[a];break;case 25:this.$=o[a];break;case 26:this.$=[{command:"bar",type:o[a],_l:u[a].first_line,_c:u[a].first_column}];break;case 27:this.$=[{command:"open_beam",_l:u[a].first_line,_c:u[a].first_column}];break;case 28:this.$=[{command:"close_beam",_l:u[a].first_line,_c:u[a].first_column}];break;case 29:this.$=[{command:"tuplet",params:o[a],_l:u[a].first_line,_c:u[a].first_column}];break;case 30:this.$=[{command:"annotations",params:o[a],_l:u[a].first_line,_c:u[a].first_column}];break;case 31:this.$=[{command:"rest",params:o[a]}];break;case 32:this.$="single";break;case 33:this.$="double";break;case 34:this.$="end";break;case 35:this.$="repeat-end";break;case 36:this.$="repeat-begin";break;case 37:this.$="repeat-both";break;case 38:_.extend(_.last(o[a-3]),{decorator:o[a-2]}),_.each(o[a-3],function(e){e.string=o[a]}),this.$=o[a-3];break;case 39:this.$=o[a];break;case 40:this.$=[].concat(o[a-2],o[a]);break;case 41:this.$=[{chord:o[a-2],decorator:o[a]}];break;case 42:this.$=[{chord:o[a-2],articulation:o[a-4],decorator:o[a]}];break;case 43:this.$=[{fret:o[a],_l:u[a].first_line,_c:u[a].first_column}];break;case 44:this.$=[{abc:o[a],_l:u[a].first_line,_c:u[a].first_column}];break;case 45:this.$=[_.extend(o[a],{articulation:o[a-1]})];break;case 46:_.extend(_.last(o[a-3]),{decorator:o[a-2]}),_.extend(o[a],{articulation:o[a-1]}),o[a-3].push(o[a]),this.$=o[a-3];break;case 47:this.$={time:o[a-3],dot:o[a-2],fret:o[a],_l:u[a-4].first_line,_c:u[a-4].first_column};break;case 48:this.$={fret:o[a],_l:u[a].first_line,_c:u[a].first_column};break;case 49:this.$={time:o[a-3],dot:o[a-2],abc:o[a]};break;case 50:this.$={abc:o[a],_l:u[a].first_line,_c:u[a].first_column};break;case 51:this.$={time:o[a-1],dot:o[a]};break;case 52:this.$=o[a-1]+o[a];break;case 53:this.$=o[a];break;case 54:this.$=o[a];break;case 55:this.$=o[a];break;case 56:this.$=o[a];break;case 57:this.$=!1;break;case 58:this.$=!0;break;case 59:this.$="";break;case 60:this.$="s";break;case 61:this.$=o[a];break;case 62:this.$="-";break;case 63:this.$="s";break;case 64:this.$="t";break;case 65:this.$="T";break;case 66:this.$="b";break;case 67:this.$="h";break;case 68:this.$="p";break;case 69:this.$="v";break;case 70:this.$="V";break;case 71:this.$="u";break;case 72:this.$="d";break;case 73:this.$=null;break;case 74:this.$={tuplet:o[a-1]};break;case 75:this.$={tuplet:o[a-3],notes:o[a-1]};break;case 76:this.$=o[a-1];break;case 77:this.$=[o[a]];break;case 78:this.$=[].concat(o[a-2],o[a]);break;case 79:this.$={position:0};break;case 80:this.$={position:o[a-1]};break;case 81:this.$={position:o[a-1]*-1};break;case 82:this.$={key:o[a-2],accidental:o[a-1],accidental_type:o[a]};break;case 83:this.$="#";break;case 84:this.$="##";break;case 85:this.$="b";break;case 86:this.$="bb";break;case 87:this.$="n";break;case 89:this.$=null;break;case 90:this.$="c"}},table:[{3:1,4:2,5:[2,2],6:3,7:4,8:5,11:[1,6],13:[1,7],14:[1,8]},{1:[3]},{5:[1,9]},{5:[2,3],7:10,8:5,11:[1,6],13:[1,7],14:[1,8]},{5:[2,4],11:[2,4],13:[2,4],14:[2,4]},{5:[2,15],9:11,11:[2,15],12:12,13:[2,15],14:[2,15],16:[2,15],18:[2,15],20:[1,13]},{12:14,20:[1,13]},{5:[2,9],11:[2,9],13:[2,9],14:[2,9],16:[2,9],18:[2,9],20:[2,9]},{5:[2,10],11:[2,10],13:[2,10],14:[2,10],16:[2,10],18:[2,10],20:[2,10]},{1:[2,1]},{5:[2,5],11:[2,5],13:[2,5],14:[2,5]},{5:[2,7],10:15,11:[2,7],13:[2,7],14:[2,7],15:16,16:[1,17],18:[1,18]},{5:[2,16],11:[2,16],13:[2,16],14:[2,16],16:[2,16],18:[2,16],20:[1,19]},{21:[1,20]},{5:[2,8],11:[2,8],13:[2,8],14:[2,8],20:[1,19]},{5:[2,6],11:[2,6],13:[2,6],14:[2,6],15:21,16:[1,17],18:[1,18]},{5:[2,11],11:[2,11],13:[2,11],14:[2,11],16:[2,11],18:[2,11]},{17:22,22:[1,23]},{19:24,21:[1,40],24:25,25:26,26:27,27:28,28:29,29:[1,30],30:[1,31],31:32,32:33,33:34,34:[1,39],35:[1,38],36:35,42:[1,36],44:37,45:[1,44],46:45,53:[1,51],57:[1,46],58:[1,47],59:[1,48],60:[1,49],61:[1,50],62:[1,52],66:[1,41],67:[1,42],69:[1,43],70:[1,53]},{21:[1,54]},{20:[1,55]},{5:[2,12],11:[2,12],13:[2,12],14:[2,12],16:[2,12],18:[2,12]},{5:[2,13],11:[2,13],13:[2,13],14:[2,13],16:[2,13],18:[2,13],23:[1,56]},{5:[2,19],11:[2,19],13:[2,19],14:[2,19],16:[2,19],18:[2,19],23:[2,19]},{5:[2,14],11:[2,14],13:[2,14],14:[2,14],16:[2,14],18:[2,14],21:[1,40],24:57,25:26,26:27,27:28,28:29,29:[1,30],30:[1,31],31:32,32:33,33:34,34:[1,39],35:[1,38],36:35,42:[1,36],44:37,45:[1,44],46:45,53:[1,51],57:[1,46],58:[1,47],59:[1,48],60:[1,49],61:[1,50],62:[1,52],66:[1,41],67:[1,42],69:[1,43],70:[1,53]},{5:[2,21],11:[2,21],13:[2,21],14:[2,21],16:[2,21],18:[2,21],21:[2,21],29:[2,21],30:[2,21],34:[2,21],35:[2,21],42:[2,21],45:[2,21],53:[2,21],57:[2,21],58:[2,21],59:[2,21],60:[2,21],61:[2,21],62:[2,21],66:[2,21],67:[2,21],69:[2,21],70:[2,21]},{5:[2,23],11:[2,23],13:[2,23],14:[2,23],16:[2,23],18:[2,23],21:[2,23],29:[2,23],30:[2,23],34:[2,23],35:[2,23],42:[2,23],45:[2,23],53:[2,23],57:[2,23],58:[2,23],59:[2,23],60:[2,23],61:[2,23],62:[2,23],66:[2,23],67:[2,23],69:[2,23],70:[2,23]},{5:[2,24],11:[2,24],13:[2,24],14:[2,24],16:[2,24],18:[2,24],21:[2,24],29:[2,24],30:[2,24],34:[2,24],35:[2,24],42:[2,24],45:[2,24],53:[2,24],57:[2,24],58:[2,24],59:[2,24],60:[2,24],61:[2,24],62:[2,24],66:[2,24],67:[2,24],69:[2,24],70:[2,24]},{5:[2,25],11:[2,25],13:[2,25],14:[2,25],16:[2,25],18:[2,25],21:[2,25],29:[2,25],30:[2,25],34:[2,25],35:[2,25],42:[2,25],45:[2,25],53:[2,25],57:[2,25],58:[2,25],59:[2,25],60:[2,25],61:[2,25],62:[2,25],66:[2,25],67:[2,25],69:[2,25],70:[2,25]},{5:[2,26],11:[2,26],13:[2,26],14:[2,26],16:[2,26],18:[2,26],21:[2,26],29:[2,26],30:[2,26],34:[2,26],35:[2,26],42:[2,26],45:[2,26],53:[2,26],57:[2,26],58:[2,26],59:[2,26],60:[2,26],61:[2,26],62:[2,26],66:[2,26],67:[2,26],69:[2,26],70:[2,26]},{5:[2,27],11:[2,27],13:[2,27],14:[2,27],16:[2,27],18:[2,27],21:[2,27],29:[2,27],30:[2,27],34:[2,27],35:[2,27],42:[2,27],45:[2,27],53:[2,27],57:[2,27],58:[2,27],59:[2,27],60:[2,27],61:[2,27],62:[2,27],66:[2,27],67:[2,27],69:[2,27],70:[2,27]},{5:[2,28],11:[2,28],13:[2,28],14:[2,28],16:[2,28],18:[2,28],21:[2,28],29:[2,28],30:[2,28],34:[2,28],35:[2,28],42:[2,28],45:[2,28],53:[2,28],57:[2,28],58:[2,28],59:[2,28],60:[2,28],61:[2,28],62:[2,28],66:[2,28],67:[2,28],69:[2,28],70:[2,28]},{5:[2,29],11:[2,29],13:[2,29],14:[2,29],16:[2,29],18:[2,29],21:[2,29],29:[2,29],30:[2,29],34:[2,29],35:[2,29],42:[2,29],45:[2,29],53:[2,29],57:[2,29],58:[2,29],59:[2,29],60:[2,29],61:[2,29],62:[2,29],66:[2,29],67:[2,29],69:[2,29],70:[2,29]},{5:[2,30],11:[2,30],13:[2,30],14:[2,30],16:[2,30],18:[2,30],21:[2,30],29:[2,30],30:[2,30],34:[2,30],35:[2,30],42:[2,30],45:[2,30],53:[2,30],57:[2,30],58:[2,30],59:[2,30],60:[2,30],61:[2,30],62:[2,30],66:[2,30],67:[2,30],69:[2,30],70:[2,30]},{5:[2,31],11:[2,31],13:[2,31],14:[2,31],16:[2,31],18:[2,31],21:[2,31],29:[2,31],30:[2,31],34:[2,31],35:[2,31],42:[2,31],45:[2,31],53:[2,31],57:[2,31],58:[2,31],59:[2,31],60:[2,31],61:[2,31],62:[2,31],66:[2,31],67:[2,31],69:[2,31],70:[2,31]},{37:58,38:[2,73],53:[2,73],55:[1,62],57:[2,73],58:[2,73],59:[2,73],60:[2,73],61:[2,73],62:[2,73],63:[1,59],64:[1,60],65:[1,61]},{25:64,36:35,40:63,44:65,45:[1,44],46:45,53:[1,51],57:[1,46],58:[1,47],59:[1,48],60:[1,49],61:[1,50],62:[1,52],70:[1,53]},{35:[1,68],42:[1,66],45:[1,69],46:70,47:67,70:[1,53]},{45:[1,73],48:71,50:72,52:[1,74],53:[1,75],54:[1,76]},{5:[2,32],11:[2,32],13:[2,32],14:[2,32],16:[2,32],18:[2,32],21:[2,32],29:[2,32],30:[2,32],34:[2,32],35:[2,32],42:[2,32],45:[2,32],53:[2,32],57:[2,32],58:[2,32],59:[2,32],60:[2,32],61:[2,32],62:[2,32],66:[2,32],67:[2,32],69:[2,32],70:[2,32]},{34:[1,77],35:[1,78]},{45:[1,79]},{20:[1,81],68:80},{45:[1,83],57:[1,84],69:[1,82]},{38:[2,43],53:[2,43],55:[2,43],57:[2,43],58:[2,43],59:[2,43],60:[2,43],61:[2,43],62:[2,43],63:[2,43],64:[2,43],65:[2,43]},{38:[2,44],53:[2,44],55:[2,44],57:[2,44],58:[2,44],59:[2,44],60:[2,44],61:[2,44],62:[2,44],63:[2,44],64:[2,44],65:[2,44]},{35:[2,62],42:[2,62],45:[2,62],70:[2,62]},{35:[2,63],42:[2,63],45:[2,63],70:[2,63]},{35:[2,64],42:[2,64],45:[2,64],70:[2,64]},{35:[2,65],42:[2,65],45:[2,65],70:[2,65]},{35:[2,66],42:[2,66],45:[2,66],70:[2,66]},{35:[2,67],42:[2,67],45:[2,67],70:[2,67]},{35:[2,68],42:[2,68],45:[2,68],70:[2,68]},{38:[2,88],53:[2,88],55:[2,88],57:[2,88],58:[2,88],59:[2,88],60:[2,88],61:[2,88],62:[2,88],63:[2,88],64:[2,88],65:[2,88],69:[1,86],71:85,73:[1,87],74:[1,88],75:[2,88]},{20:[1,89]},{5:[2,17],11:[2,17],13:[2,17],14:[2,17],16:[2,17],18:[2,17],20:[2,17]},{22:[1,90]},{5:[2,22],11:[2,22],13:[2,22],14:[2,22],16:[2,22],18:[2,22],21:[2,22],29:[2,22],30:[2,22],34:[2,22],35:[2,22],42:[2,22],45:[2,22],53:[2,22],57:[2,22],58:[2,22],59:[2,22],60:[2,22],61:[2,22],62:[2,22],66:[2,22],67:[2,22],69:[2,22],70:[2,22]},{38:[1,91],44:92,53:[1,51],57:[1,46],58:[1,47],59:[1,48],60:[1,49],61:[1,50],62:[1,52]},{5:[2,69],11:[2,69],13:[2,69],14:[2,69],16:[2,69],18:[2,69],21:[2,69],29:[2,69],30:[2,69],34:[2,69],35:[2,69],38:[2,69],42:[2,69],45:[2,69],53:[2,69],57:[2,69],58:[2,69],59:[2,69],60:[2,69],61:[2,69],62:[2,69],66:[2,69],67:[2,69],69:[2,69],70:[2,69]},{5:[2,70],11:[2,70],13:[2,70],14:[2,70],16:[2,70],18:[2,70],21:[2,70],29:[2,70],30:[2,70],34:[2,70],35:[2,70],38:[2,70],42:[2,70],45:[2,70],53:[2,70],57:[2,70],58:[2,70],59:[2,70],60:[2,70],61:[2,70],62:[2,70],66:[2,70],67:[2,70],69:[2,70],70:[2,70]},{5:[2,71],11:[2,71],13:[2,71],14:[2,71],16:[2,71],18:[2,71],21:[2,71],29:[2,71],30:[2,71],34:[2,71],35:[2,71],38:[2,71],42:[2,71],45:[2,71],53:[2,71],57:[2,71],58:[2,71],59:[2,71],60:[2,71],61:[2,71],62:[2,71],66:[2,71],67:[2,71],69:[2,71],70:[2,71]},{5:[2,72],11:[2,72],13:[2,72],14:[2,72],16:[2,72],18:[2,72],21:[2,72],29:[2,72],30:[2,72],34:[2,72],35:[2,72],38:[2,72],42:[2,72],45:[2,72],53:[2,72],57:[2,72],58:[2,72],59:[2,72],60:[2,72],61:[2,72],62:[2,72],66:[2,72],67:[2,72],69:[2,72],70:[2,72]},{41:[1,94],43:[1,93]},{41:[2,39],43:[2,39]},{35:[1,68],45:[1,69],46:70,47:67,70:[1,53]},{25:64,36:35,40:95,44:65,45:[1,44],46:45,53:[1,51],57:[1,46],58:[1,47],59:[1,48],60:[1,49],61:[1,50],62:[1,52],70:[1,53]},{38:[2,45],53:[2,45],55:[2,45],57:[2,45],58:[2,45],59:[2,45],60:[2,45],61:[2,45],62:[2,45],63:[2,45],64:[2,45],65:[2,45]},{45:[1,73],48:96,50:72,52:[1,74],53:[1,75],54:[1,76]},{38:[2,48],53:[2,48],55:[2,48],57:[2,48],58:[2,48],59:[2,48],60:[2,48],61:[2,48],62:[2,48],63:[2,48],64:[2,48],65:[2,48]},{38:[2,50],53:[2,50],55:[2,50],57:[2,50],58:[2,50],59:[2,50],60:[2,50],61:[2,50],62:[2,50],63:[2,50],64:[2,50],65:[2,50]},{5:[2,57],11:[2,57],13:[2,57],14:[2,57],16:[2,57],18:[2,57],21:[2,57],29:[2,57],30:[2,57],34:[2,57],35:[2,57],42:[2,57],45:[2,57],49:97,53:[2,57],55:[1,98],57:[2,57],58:[2,57],59:[2,57],60:[2,57],61:[2,57],62:[2,57],66:[2,57],67:[2,57],69:[2,57],70:[2,57]},{5:[2,59],11:[2,59],13:[2,59],14:[2,59],16:[2,59],18:[2,59],21:[2,59],29:[2,59],30:[2,59],34:[2,59],35:[2,59],42:[2,59],45:[2,59],51:99,53:[2,59],55:[2,59],56:[1,100],57:[2,59],58:[2,59],59:[2,59],60:[2,59],61:[2,59],62:[2,59],66:[2,59],67:[2,59],69:[2,59],70:[2,59]},{5:[2,53],11:[2,53],13:[2,53],14:[2,53],16:[2,53],18:[2,53],21:[2,53],29:[2,53],30:[2,53],34:[2,53],35:[2,53],42:[2,53],45:[2,53],53:[2,53],55:[2,53],56:[2,53],57:[2,53],58:[2,53],59:[2,53],60:[2,53],61:[2,53],62:[2,53],66:[2,53],67:[2,53],69:[2,53],70:[2,53]},{5:[2,54],11:[2,54],13:[2,54],14:[2,54],16:[2,54],18:[2,54],21:[2,54],29:[2,54],30:[2,54],34:[2,54],35:[2,54],42:[2,54],45:[2,54],53:[2,54],55:[2,54],56:[2,54],57:[2,54],58:[2,54],59:[2,54],60:[2,54],61:[2,54],62:[2,54],66:[2,54],67:[2,54],69:[2,54],70:[2,54]},{5:[2,55],11:[2,55],13:[2,55],14:[2,55],16:[2,55],18:[2,55],21:[2,55],29:[2,55],30:[2,55],34:[2,55],35:[2,55],42:[2,55],45:[2,55],53:[2,55],55:[2,55],56:[2,55],57:[2,55],58:[2,55],59:[2,55],60:[2,55],61:[2,55],62:[2,55],66:[2,55],67:[2,55],69:[2,55],70:[2,55]},{5:[2,56],11:[2,56],13:[2,56],14:[2,56],16:[2,56],18:[2,56],21:[2,56],29:[2,56],30:[2,56],34:[2,56],35:[2,56],42:[2,56],45:[2,56],53:[2,56],55:[2,56],56:[2,56],57:[2,56],58:[2,56],59:[2,56],60:[2,56],61:[2,56],62:[2,56],66:[2,56],67:[2,56],69:[2,56],70:[2,56]},{21:[1,102],34:[1,101],35:[1,103]},{34:[1,104],35:[1,105]},{23:[1,107],66:[1,106]},{23:[1,109],67:[1,108]},{23:[2,77],67:[2,77]},{5:[2,79],11:[2,79],13:[2,79],14:[2,79],16:[2,79],18:[2,79],21:[2,79],29:[2,79],30:[2,79],34:[2,79],35:[2,79],42:[2,79],45:[2,79],53:[2,79],57:[2,79],58:[2,79],59:[2,79],60:[2,79],61:[2,79],62:[2,79],66:[2,79],67:[2,79],69:[2,79],70:[2,79]},{69:[1,110]},{45:[1,111]},{38:[2,89],53:[2,89],55:[2,89],57:[2,89],58:[2,89],59:[2,89],60:[2,89],61:[2,89],62:[2,89],63:[2,89],64:[2,89],65:[2,89],72:112,75:[1,113]},{38:[2,83],53:[2,83],55:[2,83],57:[2,83],58:[2,83],59:[2,83],60:[2,83],61:[2,83],62:[2,83],63:[2,83],64:[2,83],65:[2,83],69:[1,114],75:[2,83]},{38:[2,85],53:[2,85],55:[2,85],57:[2,85],58:[2,85],59:[2,85],60:[2,85],61:[2,85],62:[2,85],63:[2,85],64:[2,85],65:[2,85],73:[1,115],75:[2,85]},{38:[2,87],53:[2,87],55:[2,87],57:[2,87],58:[2,87],59:[2,87],60:[2,87],61:[2,87],62:[2,87],63:[2,87],64:[2,87],65:[2,87],75:[2,87]},{5:[2,18],11:[2,18],13:[2,18],14:[2,18],16:[2,18],18:[2,18],20:[2,18]},{5:[2,20],11:[2,20],13:[2,20],14:[2,20],16:[2,20],18:[2,20],23:[2,20]},{39:116,45:[1,117]},{35:[1,68],45:[1,69],46:70,47:118,70:[1,53]},{5:[2,73],11:[2,73],13:[2,73],14:[2,73],16:[2,73],18:[2,73],21:[2,73],29:[2,73],30:[2,73],34:[2,73],35:[2,73],37:119,42:[2,73],45:[2,73],53:[2,73],55:[1,62],57:[2,73],58:[2,73],59:[2,73],60:[2,73],61:[2,73],62:[2,73],63:[1,59],64:[1,60],65:[1,61],66:[2,73],67:[2,73],69:[2,73],70:[2,73]},{25:120,36:35,44:65,45:[1,44],46:45,53:[1,51],57:[1,46],58:[1,47],59:[1,48],60:[1,49],61:[1,50],62:[1,52],70:[1,53]},{41:[1,94],43:[1,121]},{35:[2,57],49:122,55:[1,98]},{5:[2,51],11:[2,51],13:[2,51],14:[2,51],16:[2,51],18:[2,51],21:[2,51],29:[2,51],30:[2,51],34:[2,51],35:[2,51],42:[2,51],45:[2,51],53:[2,51],57:[2,51],58:[2,51],59:[2,51],60:[2,51],61:[2,51],62:[2,51],66:[2,51],67:[2,51],69:[2,51],70:[2,51]},{5:[2,58],11:[2,58],13:[2,58],14:[2,58],16:[2,58],18:[2,58],21:[2,58],29:[2,58],30:[2,58],34:[2,58],35:[2,58],42:[2,58],45:[2,58],53:[2,58],57:[2,58],58:[2,58],59:[2,58],60:[2,58],61:[2,58],62:[2,58],66:[2,58],67:[2,58],69:[2,58],70:[2,58]},{5:[2,52],11:[2,52],13:[2,52],14:[2,52],16:[2,52],18:[2,52],21:[2,52],29:[2,52],30:[2,52],34:[2,52],35:[2,52],42:[2,52],45:[2,52],53:[2,52],55:[2,52],57:[2,52],58:[2,52],59:[2,52],60:[2,52],61:[2,52],62:[2,52],66:[2,52],67:[2,52],69:[2,52],70:[2,52]},{5:[2,60],11:[2,60],13:[2,60],14:[2,60],16:[2,60],18:[2,60],21:[2,60],29:[2,60],30:[2,60],34:[2,60],35:[2,60],42:[2,60],45:[2,60],53:[2,60],55:[2,60],57:[2,60],58:[2,60],59:[2,60],60:[2,60],61:[2,60],62:[2,60],66:[2,60],67:[2,60],69:[2,60],70:[2,60]},{5:[2,33],11:[2,33],13:[2,33],14:[2,33],16:[2,33],18:[2,33],21:[2,33],29:[2,33],30:[2,33],34:[2,33],35:[2,33],42:[2,33],45:[2,33],53:[2,33],57:[2,33],58:[2,33],59:[2,33],60:[2,33],61:[2,33],62:[2,33],66:[2,33],67:[2,33],69:[2,33],70:[2,33]},{5:[2,34],11:[2,34],13:[2,34],14:[2,34],16:[2,34],18:[2,34],21:[2,34],29:[2,34],30:[2,34],34:[2,34],35:[2,34],42:[2,34],45:[2,34],53:[2,34],57:[2,34],58:[2,34],59:[2,34],60:[2,34],61:[2,34],62:[2,34],66:[2,34],67:[2,34],69:[2,34],70:[2,34]},{5:[2,36],11:[2,36],13:[2,36],14:[2,36],16:[2,36],18:[2,36],21:[2,36],29:[2,36],30:[2,36],34:[2,36],35:[2,36],42:[2,36],45:[2,36],53:[2,36],57:[2,36],58:[2,36],59:[2,36],60:[2,36],61:[2,36],62:[2,36],66:[2,36],67:[2,36],69:[2,36],70:[2,36]},{5:[2,35],11:[2,35],13:[2,35],14:[2,35],16:[2,35],18:[2,35],21:[2,35],29:[2,35],30:[2,35],34:[2,35],35:[2,35],42:[2,35],45:[2,35],53:[2,35],57:[2,35],58:[2,35],59:[2,35],60:[2,35],61:[2,35],62:[2,35],66:[2,35],67:[2,35],69:[2,35],70:[2,35]},{5:[2,37],11:[2,37],13:[2,37],14:[2,37],16:[2,37],18:[2,37],21:[2,37],29:[2,37],30:[2,37],34:[2,37],35:[2,37],42:[2,37],45:[2,37],53:[2,37],57:[2,37],58:[2,37],59:[2,37],60:[2,37],61:[2,37],62:[2,37],66:[2,37],67:[2,37],69:[2,37],70:[2,37]},{5:[2,74],11:[2,74],13:[2,74],14:[2,74],16:[2,74],18:[2,74],21:[2,74],29:[2,74],30:[2,74],34:[2,74],35:[2,74],42:[2,74],45:[2,74],53:[2,74],57:[2,74],58:[2,74],59:[2,74],60:[2,74],61:[2,74],62:[2,74],66:[2,74],67:[2,74],69:[2,74],70:[2,74]},{45:[1,123]},{5:[2,76],11:[2,76],13:[2,76],14:[2,76],16:[2,76],18:[2,76],21:[2,76],29:[2,76],30:[2,76],34:[2,76],35:[2,76],42:[2,76],45:[2,76],53:[2,76],57:[2,76],58:[2,76],59:[2,76],60:[2,76],61:[2,76],62:[2,76],66:[2,76],67:[2,76],69:[2,76],70:[2,76]},{20:[1,124]},{5:[2,80],11:[2,80],13:[2,80],14:[2,80],16:[2,80],18:[2,80],21:[2,80],29:[2,80],30:[2,80],34:[2,80],35:[2,80],42:[2,80],45:[2,80],53:[2,80],57:[2,80],58:[2,80],59:[2,80],60:[2,80],61:[2,80],62:[2,80],66:[2,80],67:[2,80],69:[2,80],70:[2,80]},{69:[1,125]},{38:[2,82],53:[2,82],55:[2,82],57:[2,82],58:[2,82],59:[2,82],60:[2,82],61:[2,82],62:[2,82],63:[2,82],64:[2,82],65:[2,82]},{38:[2,90],53:[2,90],55:[2,90],57:[2,90],58:[2,90],59:[2,90],60:[2,90],61:[2,90],62:[2,90],63:[2,90],64:[2,90],65:[2,90]},{38:[2,84],53:[2,84],55:[2,84],57:[2,84],58:[2,84],59:[2,84],60:[2,84],61:[2,84],62:[2,84],63:[2,84],64:[2,84],65:[2,84],75:[2,84]},{38:[2,86],53:[2,86],55:[2,86],57:[2,86],58:[2,86],59:[2,86],60:[2,86],61:[2,86],62:[2,86],63:[2,86],64:[2,86],65:[2,86],75:[2,86]},{5:[2,38],11:[2,38],13:[2,38],14:[2,38],16:[2,38],18:[2,38],21:[2,38],29:[2,38],30:[2,38],34:[2,38],35:[2,38],41:[2,38],42:[2,38],43:[2,38],45:[2,38],53:[2,38],57:[2,38],58:[2,38],59:[2,38],60:[2,38],61:[2,38],62:[2,38],66:[2,38],67:[2,38],69:[2,38],70:[2,38]},{5:[2,61],11:[2,61],13:[2,61],14:[2,61],16:[2,61],18:[2,61],21:[2,61],29:[2,61],30:[2,61],34:[2,61],35:[2,61],41:[2,61],42:[2,61],43:[2,61],45:[2,61],53:[2,61],57:[2,61],58:[2,61],59:[2,61],60:[2,61],61:[2,61],62:[2,61],66:[2,61],67:[2,61],69:[2,61],70:[2,61]},{38:[2,46],53:[2,46],55:[2,46],57:[2,46],58:[2,46],59:[2,46],60:[2,46],61:[2,46],62:[2,46],63:[2,46],64:[2,46],65:[2,46]},{5:[2,41],11:[2,41],13:[2,41],14:[2,41],16:[2,41],18:[2,41],21:[2,41],29:[2,41],30:[2,41],34:[2,41],35:[2,41],42:[2,41],45:[2,41],53:[2,41],57:[2,41],58:[2,41],59:[2,41],60:[2,41],61:[2,41],62:[2,41],66:[2,41],67:[2,41],69:[2,41],70:[2,41]},{41:[2,40],43:[2,40]},{5:[2,73],11:[2,73],13:[2,73],14:[2,73],16:[2,73],18:[2,73],21:[2,73],29:[2,73],30:[2,73],34:[2,73],35:[2,73],37:126,42:[2,73],45:[2,73],53:[2,73],55:[1,62],57:[2,73],58:[2,73],59:[2,73],60:[2,73],61:[2,73],62:[2,73],63:[1,59],64:[1,60],65:[1,61],66:[2,73],67:[2,73],69:[2,73],70:[2,73]},{35:[1,127]},{66:[1,128]},{23:[2,78],67:[2,78]},{5:[2,81],11:[2,81],13:[2,81],14:[2,81],16:[2,81],18:[2,81],21:[2,81],29:[2,81],30:[2,81],34:[2,81],35:[2,81],42:[2,81],45:[2,81],53:[2,81],57:[2,81],58:[2,81],59:[2,81],60:[2,81],61:[2,81],62:[2,81],66:[2,81],67:[2,81],69:[2,81],70:[2,81]},{5:[2,42],11:[2,42],13:[2,42],14:[2,42],16:[2,42],18:[2,42],21:[2,42],29:[2,42],30:[2,42],34:[2,42],35:[2,42],42:[2,42],45:[2,42],53:[2,42],57:[2,42],58:[2,42],59:[2,42],60:[2,42],61:[2,42],62:[2,42],66:[2,42],67:[2,42],69:[2,42],70:[2,42]},{45:[1,129],46:130,70:[1,53]},{5:[2,75],11:[2,75],13:[2,75],14:[2,75],16:[2,75],18:[2,75],21:[2,75],29:[2,75],30:[2,75],34:[2,75],35:[2,75],42:[2,75],45:[2,75],53:[2,75],57:[2,75],58:[2,75],59:[2,75],60:[2,75],61:[2,75],62:[2,75],66:[2,75],67:[2,75],69:[2,75],70:[2,75]},{38:[2,47],53:[2,47],55:[2,47],57:[2,47],58:[2,47],59:[2,47],60:[2,47],61:[2,47],62:[2,47],63:[2,47],64:[2,47],65:[2,47]},{38:[2,49],53:[2,49],55:[2,49],57:[2,49],58:[2,49],59:[2,49],60:[2,49],61:[2,49],62:[2,49],63:[2,49],64:[2,49],65:[2,49]}],defaultActions:{9:[2,1]},parseError:function(t,n){throw new Error(t)},parse:function(t){function v(e){r.length=r.length-2*e,i.length=i.length-e,s.length=s.length-e}function m(){var e;return e=n.lexer.lex()||1,typeof e!="number"&&(e=n.symbols_[e]||e),e}var n=this,r=[0],i=[null],s=[],o=this.table,u="",a=0,f=0,l=0,c=2,h=1;this.lexer.setInput(t),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,typeof this.lexer.yylloc=="undefined"&&(this.lexer.yylloc={});var p=this.lexer.yylloc;s.push(p);var d=this.lexer.options&&this.lexer.options.ranges;typeof this.yy.parseError=="function"&&(this.parseError=this.yy.parseError);var g,y,b,w,E,S,x={},T,N,C,k;for(;;){b=r[r.length-1];if(this.defaultActions[b])w=this.defaultActions[b];else{if(g===null||typeof g=="undefined")g=m();w=o[b]&&o[b][g]}if(typeof w=="undefined"||!w.length||!w[0]){var L="";if(!l){k=[];for(T in o[b])this.terminals_[T]&&T>2&&k.push("'"+this.terminals_[T]+"'");this.lexer.showPosition?L="Parse error on line "+(a+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+k.join(", ")+", got '"+(this.terminals_[g]||g)+"'":L="Parse error on line "+(a+1)+": Unexpected "+(g==1?"end of input":"'"+(this.terminals_[g]||g)+"'"),this.parseError(L,{text:this.lexer.match,token:this.terminals_[g]||g,line:this.lexer.yylineno,loc:p,expected:k})}}if(w[0]instanceof Array&&w.length>1)throw new Error("Parse Error: multiple actions possible at state: "+b+", token: "+g);switch(w[0]){case 1:r.push(g),i.push(this.lexer.yytext),s.push(this.lexer.yylloc),r.push(w[1]),g=null,y?(g=y,y=null):(f=this.lexer.yyleng,u=this.lexer.yytext,a=this.lexer.yylineno,p=this.lexer.yylloc,l>0&&l--);break;case 2:N=this.productions_[w[1]][1],x.$=i[i.length-N],x._$={first_line:s[s.length-(N||1)].first_line,last_line:s[s.length-1].last_line,first_column:s[s.length-(N||1)].first_column,last_column:s[s.length-1].last_column},d&&(x._$.range=[s[s.length-(N||1)].range[0],s[s.length-1].range[1]]),S=this.performAction.call(x,u,f,a,this.yy,w[1],i,s);if(typeof S!="undefined")return S;N&&(r=r.slice(0,-1*N*2),i=i.slice(0,-1*N),s=s.slice(0,-1*N)),r.push(this.productions_[w[1]][0]),i.push(x.$),s.push(x._$),C=o[r[r.length-2]][r[r.length-1]],r.push(C);break;case 3:return!0}}return!0}};Vex.L("Starting parser.");var t=function(){var e={EOF:1,parseError:function(t,n){if(!this.yy.parser)throw new Error(t);this.yy.parser.parseError(t,n)},setInput:function(e){return this._input=e,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var e=this._input[0];this.yytext+=e,this.yyleng++,this.offset++,this.match+=e,this.matched+=e;var t=e.match(/(?:\r\n?|\n).*/g);return t?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),e},unput:function(e){var t=e.length,n=e.split(/(?:\r\n?|\n)/g);this._input=e+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-t-1),this.offset-=t;var r=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),n.length-1&&(this.yylineno-=n.length-1);var i=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:n?(n.length===r.length?this.yylloc.first_column:0)+r[r.length-n.length].length-n[0].length:this.yylloc.first_column-t},this.options.ranges&&(this.yylloc.range=[i[0],i[0]+this.yyleng-t]),this},more:function(){return this._more=!0,this},less:function(e){this.unput(this.match.slice(e))},pastInput:function(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(e.length>20?"...":"")+e.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var e=this.match;return e.length<20&&(e+=this._input.substr(0,20-e.length)),(e.substr(0,20)+(e.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var e=this.pastInput(),t=(new Array(e.length+1)).join("-");return e+this.upcomingInput()+"\n"+t+"^"},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var e,t,n,r,i,s;this._more||(this.yytext="",this.match="");var o=this._currentRules();for(var u=0;u<o.length;u++){n=this._input.match(this.rules[o[u]]);if(n&&(!t||n[0].length>t[0].length)){t=n,r=u;if(!this.options.flex)break}}if(t){s=t[0].match(/(?:\r\n?|\n).*/g),s&&(this.yylineno+=s.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:s?s[s.length-1].length-s[s.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+t[0].length},this.yytext+=t[0],this.match+=t[0],this.matches=t,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._input=this._input.slice(t[0].length),this.matched+=t[0],e=this.performAction.call(this,this.yy,this,o[r],this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1);if(e)return e;return}return this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var t=this.next();return typeof t!="undefined"?t:this.lex()},begin:function(t){this.conditionStack.push(t)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(t){this.begin(t)}};return e.options={},e.performAction=function(t,n,r,i){var s=i;switch(r){case 0:return this.begin("notes"),18;case 1:return this.begin("options"),13;case 2:return this.begin("options"),"STAVE";case 3:return this.begin("options"),14;case 4:return this.begin("options"),11;case 5:return this.begin("text"),16;case 6:return 20;case 7:return this.begin("annotations"),"$";case 8:return this.begin("notes"),"$";case 9:return 20;case 10:return 22;case 11:return 38;case 12:return"+";case 13:return 35;case 14:return 21;case 15:return 42;case 16:return 43;case 17:return 29;case 18:return 30;case 19:return 66;case 20:return 23;case 21:return 34;case 22:return 41;case 23:return 69;case 24:return 73;case 25:return 61;case 26:return 58;case 27:return 53;case 28:return 62;case 29:return 59;case 30:return 60;case 31:return 57;case 32:return 63;case 33:return 64;case 34:return 65;case 35:return 55;case 36:return 45;case 37:return 54;case 38:return 52;case 39:return 53;case 40:return 55;case 41:return 56;case 42:return 70;case 43:return 74;case 44:return 75;case 45:this.begin("INITIAL");break;case 46:break;case 47:return 5;case 48:return"INVALID"}},e.rules=[/^(?:notes\b)/,/^(?:tabstave\b)/,/^(?:stave\b)/,/^(?:voice\b)/,/^(?:options\b)/,/^(?:text\b)/,/^(?:[^\s=]+)/,/^(?:[$])/,/^(?:[$])/,/^(?:[^,$]+)/,/^(?:[^,\r\n]+)/,/^(?:\/)/,/^(?:\+)/,/^(?::)/,/^(?:=)/,/^(?:\()/,/^(?:\))/,/^(?:\[)/,/^(?:\])/,/^(?:\^)/,/^(?:,)/,/^(?:\|)/,/^(?:\.)/,/^(?:#)/,/^(?:@)/,/^(?:[b])/,/^(?:[s])/,/^(?:[h])/,/^(?:[p])/,/^(?:[t])/,/^(?:[T])/,/^(?:[-])/,/^(?:[v])/,/^(?:[V])/,/^(?:[u])/,/^(?:[d])/,/^(?:[0-9]+)/,/^(?:[q])/,/^(?:[w])/,/^(?:[h])/,/^(?:[d])/,/^(?:[S])/,/^(?:[A-GX])/,/^(?:[n])/,/^(?:[~])/,/^(?:[\r\n]+)/,/^(?:\s+)/,/^(?:$)/,/^(?:.)/],e.conditions={notes:{rules:[7,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48],inclusive:!0},text:{rules:[10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,36,37,38,39,40,45,46,47,48],inclusive:!0},annotations:{rules:[8,9,11,12,13,14,15,16,17,18,19,20,21,22,23,24,45,46,47,48],inclusive:!0},options:{rules:[6,11,12,13,14,15,16,17,18,19,20,21,22,23,24,45,46,47,48],inclusive:!0},INITIAL:{rules:[0,1,2,3,4,5,6,11,12,13,14,15,16,17,18,19,20,21,22,23,24,45,46,47,48],inclusive:!0}},e}();return e.lexer=t,n.prototype=e,e.Parser=n,new n}();typeof require!="undefined"&&typeof exports!="undefined"&&(exports.parser=vextab_parser,exports.Parser=vextab_parser.Parser,exports.parse=function(){return vextab_parser.parse.apply(vextab_parser,arguments)},exports.main=function(t){if(!t[1])throw new Error("Usage: "+t[0]+" FILE");var n,r;return typeof process!="undefined"?n=require("fs").readFileSync(require("path").resolve(t[1]),"utf8"):n=require("file").path(require("file").cwd()).join(t[1]).read({charset:"utf-8"}),exports.parser.parse(n)},typeof module!="undefined"&&require.main===module&&exports.main(typeof process!="undefined"?process.argv.slice(1):require("system").args));/**
 * VexFlow TabDiv
 * Copyright Mohit Muthanna 2010 <mohit@muthanna.com>
 */
Vex.Flow.TabDiv=function(e,t){arguments.length>0&&this.init(e,t)},Vex.Flow.TabDiv.SEL=".vex-tabdiv",Vex.Flow.TabDiv.ERROR_NOCANVAS="<b>This browser does not support HTML5 Canvas</b><br/>Please use a modern browser such as <a href='http://google.com/chrome'>Google Chrome</a> or <a href='http://firefox.com'>Firefox</a>.",Vex.Flow.TabDiv.prototype.init=function(e,t){this.sel=e,this.code=$(e).text(),$(e).empty(),$(e).css("position")=="static"&&$(e).css("position","relative"),this.width=$(e).attr("width")||400,this.height=$(e).attr("height")||200,this.scale=$(e).attr("scale")||1,typeof Raphael=="undefined"?(this.canvas=$("<canvas></canvas>").addClass("vex-canvas"),$(e).append(this.canvas),this.renderer=new Vex.Flow.Renderer(this.canvas[0],Vex.Flow.Renderer.Backends.CANVAS)):(this.canvas=$("<div></div>").addClass("vex-canvas"),$(e).append(this.canvas),this.renderer=new Vex.Flow.Renderer(this.canvas[0],Vex.Flow.Renderer.Backends.RAPHAEL)),this.ctx_sel=$(e).find(".vex-canvas"),this.renderer.resize(this.width,this.height),this.ctx=this.renderer.getContext(),this.ctx.setBackgroundFillStyle(this.ctx_sel.css("background-color")),this.ctx.scale(this.scale,this.scale),this.editor=$(e).attr("editor")||"",this.show_errors=$(e).attr("show-errors")||"",this.editor_width=$(e).attr("editor_width")||this.width,this.editor_height=$(e).attr("editor_height")||200;var n=this;this.editor=="true"&&(this.text_area=$("<textarea></textarea>").addClass("editor").val(this.code),this.editor_error=$("<div></div>").addClass("editor-error"),$(e).append($("<p/>")).append(this.editor_error),$(e).append($("<p/>")).append(this.text_area),this.text_area.width(this.editor_width),this.text_area.height(this.editor_height),this.text_area.keyup(function(){n.timeoutID&&window.clearTimeout(n.timeoutID),n.timeoutID=window.setTimeout(function(){n.code!=n.text_area.val()&&(n.code=n.text_area.val(),n.redraw())},250)})),this.show_errors=="true"&&(this.editor_error=$("<div></div>").addClass("editor-error"),$(e).append($("<p/>")).append(this.editor_error)),this.artist=new Vex.Flow.Artist(10,0,this.width,{scale:this.scale}),this.parser=new Vex.Flow.VexTab(this.artist),Vex.Flow.Player&&(opts={},t&&(opts.soundfont_url=t.soundfont_url),this.player=new Vex.Flow.Player(this.artist,opts)),Vex.Flow.TabDiv.NOLOGO?this.extra_height=10:(this.message="vexflow.com",this.extra_height=20),Vex.Flow.TabDiv.HEIGHT_ADJUSTMENT&&(this.extra_height+=Vex.Flow.TabDiv.HEIGHT_ADJUSTMENT),this.redraw()},Vex.Flow.TabDiv.prototype.redraw=function(){var e=this;return Vex.BM("Total render time: ",function(){e.parse(),e.draw()}),this},Vex.Flow.TabDiv.prototype.drawInternal=function(){return this.parser.isValid()?this.artist.draw(this.renderer):this},Vex.Flow.TabDiv.prototype.parseInternal=function(){try{this.artist.reset(),this.parser.reset(),this.parser.parse(this.code),this.editor_error.empty()}catch(e){this.editor_error&&(this.editor_error.empty(),this.editor_error.append($("<div></div>").addClass("text").html("Sucky VexTab: "+e.message)))}return this},Vex.Flow.TabDiv.prototype.parse=function(){var e=this;return Vex.BM("Parse time: ",function(){e.parseInternal()}),this},Vex.Flow.TabDiv.prototype.draw=function(){var e=this;return Vex.BM("Draw time: ",function(){e.drawInternal()}),this},Vex.Flow.TabDiv.start=function(){$(Vex.Flow.TabDiv.SEL).each(function(e){new Vex.Flow.TabDiv(this)})},$(function(){Vex.Flow.TabDiv.SEL&&Vex.Flow.TabDiv.start()});// Generated by CoffeeScript 1.4.0
(function(){var e=[].slice,t=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};Vex.Flow.Artist=function(){function f(e,t,n,r){this.x=e,this.y=t,this.width=n,this.options={font_face:"Arial",font_size:10,font_style:null,bottom_spacing:20,tab_stave_lower_spacing:10,note_stave_lower_spacing:0,scale:1},r!=null&&_.extend(this.options,r),this.reset()}var n,r,i,s,o,u,a;return f.DEBUG=!1,n=function(){var t;t=1<=arguments.length?e.call(arguments,0):[];if(Vex.Flow.Artist.DEBUG)return typeof console!="undefined"&&console!==null?console.log.apply(console,["(Vex.Flow.Artist)"].concat(e.call(t))):void 0},f.prototype.reset=function(){return this.tuning=new Vex.Flow.Tuning,this.key_manager=new Vex.Flow.KeyManager("C"),this.music_api=new Vex.Flow.Music,this.customizations={"font-size":this.options.font_size,"font-face":this.options.font_face,"font-style":this.options.font_style,"annotation-position":"bottom",scale:this.options.scale,width:this.width,"stave-distance":0,space:0,player:"false",tempo:120,instrument:"acoustic_grand_piano",accidentals:"standard"},this.staves=[],this.tab_articulations=[],this.stave_articulations=[],this.player_voices=[],this.last_y=this.y,this.current_duration="q",this.current_clef="treble",this.current_bends={},this.bend_start_index=null,this.bend_start_strings=null,this.rendered=!1,this.renderer_context=null},f.prototype.attachPlayer=function(e){return this.player=e},f.prototype.setOptions=function(e){var r,i,s;n("setOptions: ",e),s=_.keys(this.customizations);for(r in e){i=e[r];if(!(t.call(s,r)>=0))throw new Vex.RERR("ArtistError","Invalid option '"+r+"'");this.customizations[r]=i}this.last_y+=parseInt(this.customizations.space,10);if(this.customizations.player==="true")return this.last_y+=15},f.prototype.getPlayerData=function(){return{voices:this.player_voices,context:this.renderer_context,scale:this.customizations.scale}},r=function(e,t,n,r){var i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C;t!=null&&(d=t.stave),n!=null&&(c=n.stave),v=[],h=[],g=[],i=[],s=null,m=null;if(t!=null){N=t.voices;for(b=0,S=N.length;b<S;b++){l=N[b];if(_.isEmpty(l))continue;_.each(l,function(e){return e.setStave(d)}),y=(new Vex.Flow.Voice(Vex.Flow.TIME4_4)).setMode(Vex.Flow.Voice.Mode.SOFT),y.addTickables(l),v.push(y)}s=d,m=d}if(n!=null){f=n.voices.length>1?!0:!1,C=n.voices;for(a=w=0,x=C.length;w<x;a=++w){l=C[a];if(_.isEmpty(l))continue;p=a===0?1:-1,_.each(l,function(e){return e.setStave(c)}),y=(new Vex.Flow.Voice(Vex.Flow.TIME4_4)).setMode(Vex.Flow.Voice.Mode.SOFT),y.addTickables(l),h.push(y),f?i=i.concat(Vex.Flow.Beam.applyAndGetBeams(y,p)):i=Vex.Flow.Beam.applyAndGetBeams(y)}s=c,m=c}for(E=0,T=r.length;E<T;E++){l=r[E];if(_.isEmpty(l))continue;_.each(l,function(e){return e.setStave(m)}),y=(new Vex.Flow.Voice(Vex.Flow.TIME4_4)).setMode(Vex.Flow.Voice.Mode.SOFT),y.addTickables(l),g.push(y)}if(s!=null)return o=[],u=new Vex.Flow.Formatter,t!=null&&(_.isEmpty(v)||u.joinVoices(v),o=v),n!=null&&(_.isEmpty(h)||u.joinVoices(h),o=o.concat(h)),!_.isEmpty(r)&&!_.isEmpty(g)&&(u.joinVoices(g),o=o.concat(g)),_.isEmpty(o)||u.formatToStave(o,s),t!=null&&_.each(v,function(t){return t.draw(e,d)}),n!=null&&_.each(h,function(t){return t.draw(e,c)}),n!=null&&_.each(i,function(t){return t.setContext(e).draw()}),_.isEmpty(r)||_.each(g,function(t){return t.draw(e,m)}),t!=null&&n!=null&&(new Vex.Flow.StaveConnector(n.stave,t.stave)).setContext(e).draw(),n!=null?h:v},f.prototype.render=function(e){var t,i,s,o,u,a,f,l,c,h,p,d,v,m;n("Render: ",this.options),this.closeBends(),e.resize(this.customizations.width*this.customizations.scale,(this.last_y+this.options.bottom_spacing)*this.customizations.scale),i=e.getContext(),i.scale(this.customizations.scale,this.customizations.scale),i.clear(),i.setFont(this.options.font_face,this.options.font_size,""),this.renderer_context=i,s=function(e,t){var n;n=_.last(t);if(n instanceof Vex.Flow.BarNote)return t.pop(),e.setEndBarType(n.getType())},d=this.staves;for(a=0,c=d.length;a<c;a++)o=d[a],n("Rendering staves."),o.tab!=null&&s(o.tab,o.tab_notes),o.note!=null&&s(o.note,o.note_notes),o.tab!=null&&o.tab.setContext(i).draw(),o.note!=null&&o.note.setContext(i).draw(),o.tab_voices.push(o.tab_notes),o.note_voices.push(o.note_notes),u=r(i,o.tab!=null?{stave:o.tab,voices:o.tab_voices}:null,o.note!=null?{stave:o.note,voices:o.note_voices}:null,o.text_voices),this.player_voices.push(u);n("Rendering tab articulations."),v=this.tab_articulations;for(f=0,h=v.length;f<h;f++)t=v[f],t.setContext(i).draw();n("Rendering note articulations."),m=this.stave_articulations;for(l=0,p=m.length;l<p;l++)t=m[l],t.setContext(i).draw();return this.player!=null&&(this.customizations.player==="true"?(this.player.setTempo(parseInt(this.customizations.tempo,10)),this.player.setInstrument(this.customizations.instrument),this.player.render()):this.player.removeControls()),this.rendered=!0},f.prototype.isRendered=function(){return this.rendered},f.prototype.draw=function(e){return this.render(e)},f.prototype.getNoteForFret=function(e,t){var n,r,i,s,o,u,a,f;a=this.tuning.getNoteForFret(e,t),f=Vex.Flow.keyProperties(a),u=this.key_manager.selectNote(f.key),n=null;switch(this.customizations.accidentals){case"standard":u.change&&(n=u.accidental!=null?u.accidental:"n");break;case"cautionary":u.change?n=u.accidental!=null?u.accidental:"n":n=u.accidental!=null?u.accidental+"_c":void 0;break;default:throw new Vex.RERR("ArtistError","Invalid value for option 'accidentals': "+this.customizations.accidentals)}return r=u.note,i=f.octave,o=this.music_api.getNoteParts(f.key).root,s=this.music_api.getNoteParts(u.note).root,s==="b"&&o==="c"?i--:s==="c"&&o==="b"&&i++,[r,i,n]},f.prototype.getNoteForABC=function(e,t){var n,r,i;return r=e.key,i=t,n=e.accidental,e.accidental_type!=null&&(n+="_"+e.accidental_type),[r,i,n]},f.prototype.addStaveNote=function(e){var t,n,r,i,s,o,u,a,f,l;i={is_rest:!1,play_note:null},_.extend(i,e),u=_.last(this.staves).note_notes,o=new Vex.Flow.StaveNote({keys:i.spec,duration:this.current_duration+(i.is_rest?"r":""),clef:i.is_rest?"treble":this.current_clef,auto_stem:i.is_rest?!1:!0}),l=i.accidentals;for(n=a=0,f=l.length;a<f;n=++a)t=l[n],t!=null&&(s=t.split("_"),r=new Vex.Flow.Accidental(s[0]),s.length>1&&s[1]==="c"&&r.setAsCautionary(),o.addAccidental(n,r));return this.current_duration[this.current_duration.length-1]==="d"&&o.addDotToAll(),i.play_note!=null&&o.setPlayNote(i.play_note),u.push(o)},f.prototype.addTabNote=function(e,t){var n,r;return t==null&&(t=null),r=_.last(this.staves).tab_notes,n=new Vex.Flow.TabNote({positions:e,duration:this.current_duration}),t!=null&&n.setPlayNote(t),r.push(n)},a=function(e,t){return e+(t?"d":"")},f.prototype.setDuration=function(e,t){var r;return t==null&&(t=!1),r=e.split(/\s+/),n("setDuration: ",r[0],t),this.current_duration=a(r[0],t)},f.prototype.addBar=function(e){var t,r,i;n("addBar: ",e),this.closeBends(),this.key_manager.reset(),i=_.last(this.staves),t=Vex.Flow.Barline.type,e=function(){switch(e){case"single":return t.SINGLE;case"double":return t.DOUBLE;case"end":return t.END;case"repeat-begin":return t.REPEAT_BEGIN;case"repeat-end":return t.REPEAT_END;case"repeat-both":return t.REPEAT_BOTH;default:return t.SINGLE}}(),r=(new Vex.Flow.BarNote).setType(e),i.tab_notes.push(r);if(i.note!=null)return i.note_notes.push(r)},u=function(e,t){var n,r;return n=Vex.Flow.Bend.UP,r="",e>t?n=Vex.Flow.Bend.DOWN:r=function(){switch(Math.abs(t-e)){case 1:return"1/2";case 2:return"Full";case 3:return"1 1/2";default:return"Bend to "+t}}(),{type:n,text:r}},f.prototype.openBends=function(e,t,r,i){var s,o,a,f,l,c,h,p,d,v,m,g,y,b,w;n("openBends",e,t,r,i),d=_.last(this.staves).tab_notes,p=e,h=r,_.isEmpty(this.current_bends)?(this.bend_start_index=d.length-2,this.bend_start_strings=r):(p=d[this.bend_start_index],h=this.bend_start_strings),s=p.getPositions(),l=t.getPositions(),w=[];for(a=g=0,y=h.length;g<y;a=++g)f=h[a],c=i[a],o=e.getPositions()[r[a]],v=l[c],(b=(m=this.current_bends)[f])==null&&(m[f]=[]),w.push(this.current_bends[f].push(u(o.fret,v.fret)));return w},f.prototype.closeBends=function(e){var t,r,i,s,o,u,a,f,l,c,h,p;e==null&&(e=1);if(this.bend_start_index==null)return;n("closeBends("+e+")"),o=_.last(this.staves).tab_notes,h=this.current_bends;for(r in h){u=h[r],i=[];for(a=0,l=u.length;a<l;a++)t=u[a],i.push(t);o[this.bend_start_index].addModifier(new Vex.Flow.Bend(null,null,i),r)}p=o.slice(this.bend_start_index+1,+(o.length-2+e)+1||9e9);for(f=0,c=p.length;f<c;f++)s=p[f],s.setGhost(!0);return this.current_bends={},this.bend_start_index=null},f.prototype.makeTuplets=function(e,t){var r,i,s;n("makeTuplets",e,t),t==null&&(t=e);if(!_.last(this.staves).note)return;i=_.last(this.staves).note_notes,s=_.last(this.staves).tab_notes;if(i.length<t)throw new Vex.RERR("ArtistError","Not enough notes for tuplet");return r=new Vex.Flow.Tuplet(i.slice(i.length-t),{num_notes:e}),this.stave_articulations.push(r),new Vex.Flow.Tuplet(s.slice(s.length-t),{num_notes:e})},i=function(e){return e.match(/^\.fingering\/([^.]+)\./)},f.prototype.makeFingering=function(e){var t,n,r,s,o,u,a,f,l,c,h,p,d,v;c=i(e),t=Vex.Flow.Modifier.Position,o=[],s=[];if(c==null)return null;o=function(){var e,t,n,r;n=c[1].split(/-/),r=[];for(e=0,t=n.length;e<t;e++)l=n[e],r.push(l.trim());return r}(),n=function(){return new Vex.RERR("ArtistError","Bad fingering: "+c[1])};for(d=0,v=o.length;d<v;d++){r=o[d],h=r.match(/(\d+):([ablr]):([fs]):([^-.]+)/);if(h==null)throw n();a=parseInt(h[1],10)-1,p=t.RIGHT;switch(h[2]){case"l":p=t.LEFT;break;case"r":p=t.RIGHT;break;case"a":p=t.ABOVE;break;case"b":p=t.BELOW}u=null,f=h[4];switch(h[3]){case"s":u=(new Vex.Flow.StringNumber(f)).setPosition(p);break;case"f":u=(new Vex.Flow.FretHandFinger(f)).setPosition(p)}s.push({num:a,modifier:u})}return s},o=function(e){return e.match(/^\.stroke\/([^.]+)\./)},f.prototype.makeStroke=function(e){var t,n,r;n=o(e),t=Vex.Flow.Stroke.Type,r=null;if(n!=null){switch(n[1]){case"bu":r=t.BRUSH_UP;break;case"bd":r=t.BRUSH_DOWN;break;case"ru":r=t.ROLL_UP;break;case"rd":r=t.ROLL_DOWN;break;case"qu":r=t.RASQUEDO_UP;break;case"qd":r=t.RASQUEDO_DOWN;break;default:throw new Vex.RERR("ArtistError","Invalid stroke type: "+n[1])}return new Vex.Flow.Stroke(r)}return null},s=function(e){return e.match(/^\.(a[^\/]*)\/(t|b)[^.]*\./)},f.prototype.makeScoreArticulation=function(e){var t,n,r,i,o;return n=s(e),n!=null?(o=n[1],i=n[2],t=Vex.Flow.Modifier.Position,r=i==="t"?t.ABOVE:t.BELOW,(new Vex.Flow.Articulation(o)).setPosition(r)):null},f.prototype.makeAnnotation=function(e){var t,n,r,i,s,o,u,a,f;i=this.customizations["font-face"],s=this.customizations["font-size"],o=this.customizations["font-style"],n=this.customizations["annotation-position"],t=Vex.Flow.Annotation.VerticalJustify,r=n==="top"?t.TOP:t.BOTTOM,a=function(e,t){return t==null&&(t=r),(new Vex.Flow.Annotation(e)).setFont(i,s,o).setVerticalJustification(t)},f=e.match(/^\.([^-]*)-([^-]*)-([^.]*)\.(.*)/);if(f!=null)return i=f[1],s=f[2],o=f[3],e=f[4],e?a(e):null;f=e.match(/^\.([^.]*)\.(.*)/);if(f!=null){u=r,e=f[2];switch(f[1]){case"big":o="bold",s="14";break;case"italic":case"italics":i="Times",o="italic";break;case"medium":s="12";break;case"top":u=t.TOP,this.customizations["annotation-position"]="top";break;case"bottom":u=t.BOTTOM,this.customizations["annotation-position"]="bottom"}return e?a(e,u):null}return a(e)},f.prototype.addAnnotations=function(e){var t,n,r,i,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x;f=_.last(this.staves),l=f.note_notes,p=f.tab_notes;if(e.length>p.length)throw new Vex.RERR("ArtistError","More annotations than note elements");if(f.tab){w=p.slice(p.length-e.length);for(i=d=0,g=w.length;d<g;i=++d)h=w[i],s(e[i])?(a=this.makeScoreArticulation(e[i]),h.addModifier(a,0)):o(e[i])?(c=this.makeStroke(e[i]),h.addModifier(c,0)):(t=this.makeAnnotation(e[i]),t&&h.addModifier(this.makeAnnotation(e[i]),0))}else{E=l.slice(l.length-e.length);for(i=v=0,y=E.length;v<y;i=++v)u=E[i],s(e[i])||(t=this.makeAnnotation(e[i]),t&&u.addAnnotation(0,this.makeAnnotation(e[i])))}if(f.note){S=l.slice(l.length-e.length),x=[];for(i=m=0,b=S.length;m<b;i=++m){u=S[i],a=this.makeScoreArticulation(e[i]),a!=null&&u.addArticulation(0,a),c=this.makeStroke(e[i]),c!=null&&u.addStroke(0,c),r=this.makeFingering(e[i]);if(r!=null)try{x.push(function(){var e,t,i;i=[];for(e=0,t=r.length;e<t;e++)n=r[e],i.push(u.addModifier(n.num,n.modifier));return i}())}catch(T){throw new Vex.RERR("ArtistError","Bad note number in fingering: "+e[i])}else x.push(void 0)}return x}},f.prototype.addTabArticulation=function(e,t,r,i,s){var o;n("addTabArticulations: ",e,t,r,i,s),e==="t"&&r.addModifier((new Vex.Flow.Annotation("T")).setVerticalJustification(Vex.Flow.Annotation.VerticalJustify.BOTTOM));if(_.isEmpty(i)&&_.isEmpty(s))return;o=null,e==="s"&&(o=new Vex.Flow.TabSlide({first_note:t,last_note:r,first_indices:i,last_indices:s}));if(e==="h"||e==="p")o=new Vex.Flow.TabTie({first_note:t,last_note:r,first_indices:i,last_indices:s},e.toUpperCase());if(e==="T"||e==="t")o=new Vex.Flow.TabTie({first_note:t,last_note:r,first_indices:i,last_indices:s}," ");e==="b"&&this.openBends(t,r,i,s);if(o!=null)return this.tab_articulations.push(o)},f.prototype.addStaveArticulation=function(e,t,r,i,s){var o;n("addStaveArticulations: ",e,t,r,i,s),o=null;if(e==="b"||e==="s"||e==="h"||e==="p"||e==="t"||e==="T")o=new Vex.Flow.StaveTie({first_note:t,last_note:r,first_indices:i,last_indices:s});if(o!=null)return this.stave_articulations.push(o)},f.prototype.getPreviousNoteIndex=function(){var e,t,n;n=_.last(this.staves).tab_notes,e=2;while(e<=n.length){t=n[n.length-e];if(t instanceof Vex.Flow.TabNote)return n.length-e;e++}return-1},f.prototype.addDecorator=function(e){var t,r,i,s,o,u;n("addDecorator: ",e);if(e==null)return;s=_.last(this.staves),o=s.tab_notes,i=s.note_notes,t=null,r=null,e==="v"&&(t=new Vex.Flow.Vibrato),e==="V"&&(t=(new Vex.Flow.Vibrato).setHarsh(!0)),e==="u"&&(t=(new Vex.Flow.Articulation("a|")).setPosition(Vex.Flow.Modifier.Position.BOTTOM),r=(new Vex.Flow.Articulation("a|")).setPosition(Vex.Flow.Modifier.Position.BOTTOM)),e==="d"&&(t=(new Vex.Flow.Articulation("am")).setPosition(Vex.Flow.Modifier.Position.BOTTOM),r=(new Vex.Flow.Articulation("am")).setPosition(Vex.Flow.Modifier.Position.BOTTOM)),t!=null&&_.last(o).addModifier(t,0);if(r!=null)return(u=_.last(i))!=null?u.addArticulation(0,r):void 0},f.prototype.addArticulations=function(e){var r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S;n("addArticulations: ",e),d=_.last(this.staves),m=d.tab_notes,v=d.note_notes;if(_.isEmpty(m)||_.isEmpty(e)){this.closeBends(0);return}s=_.last(m),o=!1,S=["b","s","h","p","t","T","v","V"];for(w=0,E=S.length;w<E;w++){y=S[w],a=function(){var t,n,i;i=[];for(u=t=0,n=e.length;t<n;u=++t)r=e[u],r!=null&&r===y&&i.push(u);return i}();if(_.isEmpty(a))continue;y==="b"&&(o=!0),c=this.getPreviousNoteIndex(),c===-1?(p=null,h=null):(p=m[c],g=function(){var e,n,r,i;r=s.getPositions(),i=[];for(u=e=0,n=r.length;e<n;u=++e)f=r[u],t.call(a,u)>=0&&i.push(f.str);return i}(),b=function(){var e,n,r,i,s;r=p.getPositions(),s=[];for(u=e=0,n=r.length;e<n;u=++e)l=r[u],(i=l.str,t.call(g,i)>=0)&&s.push(l.str);return s}(),h=function(){var e,n,r,i,s;r=p.getPositions(),s=[];for(u=e=0,n=r.length;e<n;u=++e)f=r[u],(i=f.str,t.call(b,i)>=0)&&s.push(u);return s}(),i=function(){var e,n,r,i,o;r=s.getPositions(),o=[];for(u=e=0,n=r.length;e<n;u=++e)f=r[u],(i=f.str,t.call(b,i)>=0)&&o.push(u);return o}()),d.tab!=null&&this.addTabArticulation(y,p,s,h,i),d.note!=null&&this.addStaveArticulation(y,v[c],_.last(v),h,i)}if(!o)return this.closeBends(0)},f.prototype.addRest=function(e){var t,r;return n("addRest: ",e),this.closeBends(),e.position===0?this.addStaveNote({spec:["r/4"],accidentals:[],is_rest:!0}):(t=this.tuning.getNoteForFret((parseInt(e.position,10)+5)*2,6),this.addStaveNote({spec:[t],accidentals:[],is_rest:!0})),r=_.last(this.staves).tab_notes,r.push(new Vex.Flow.GhostNote(this.current_duration))},f.prototype.addChord=function(e,t,r){var i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,A,O,M,D,P,H,B;if(_.isEmpty(e))return;n("addChord: ",e),N=_.last(this.staves),T=[],E=[],o=[],a=[],h=[],C=[],p=[],b=0,c=_.first(e).string,l=0;for(k=0,M=e.length;k<M;k++){g=e[k],b++;if(g.abc!=null||g.string!==c)l=0,c=g.string;T[l]==null&&(T[l]=[],E[l]=[],o[l]=[],C[l]=[],a[l]=[],h[l]=[]),P=[null,null,null],v=P[0],m=P[1],s=P[2],w=null;if(g.fret!=null)H=this.getNoteForFret(g.fret,g.string),v=H[0],m=H[1],s=H[2],w=this.tuning.getNoteForFret(g.fret,g.string);else{if(g.abc==null)throw new Vex.RERR("ArtistError","No note specified");B=this.getNoteForABC(g.abc,g.string),v=B[0],m=B[1],s=B[2],s!=null?i=s.split("_")[0]:i="",w=""+v+i+"/"+m,g.fret="X"}f=g.time!=null?{time:g.time,dot:g.dot}:null,T[l].push(""+v+"/"+m),E[l].push(""+w+"/"+m),o[l].push(s),C[l].push({fret:g.fret,str:g.string}),g.articulation!=null&&a[l].push(g.articulation),p[l]=f,g.decorator!=null&&(h[l]=g.decorator),l++}for(d=A=0,D=T.length;A<D;d=++A)x=T[d],S=this.current_duration,p[d]!=null&&this.setDuration(p[d].time,p[d].dot),this.addTabNote(C[d],E[d]),N.note!=null&&this.addStaveNote({spec:x,accidentals:o[d],play_note:E[d]}),this.addArticulations(a[d]),h[d]!=null&&this.addDecorator(h[d]);if(t!=null){u=[];for(y=O=1;1<=b?O<=b:O>=b;y=1<=b?++O:--O)u.push(t);this.addArticulations(u)}if(r!=null)return this.addDecorator(r)},f.prototype.addNote=function(e){return this.addChord([e])},f.prototype.addTextVoice=function(){return _.last(this.staves).text_voices.push([])},f.prototype.setTextFont=function(e){var t;if(e!=null){t=e.match(/([^-]*)-([^-]*)-([^.]*)/);if(t!=null)return this.customizations["font-face"]=t[1],this.customizations["font-size"]=parseInt(t[2],10),this.customizations["font-style"]=t[3]}},f.prototype.addTextNote=function(e,t,n,r,i){var s,o,u,a,f,l,c,h;t==null&&(t=0),n==null&&(n="center"),r==null&&(r=!0),i==null&&(i=!1),h=_.last(this.staves).text_voices;if(_.isEmpty(h))throw new Vex.RERR("ArtistError","Can't add text note without text voice");return o=this.customizations["font-face"],u=this.customizations["font-size"],a=this.customizations["font-style"],f=function(){switch(n){case"center":return Vex.Flow.TextNote.Justification.CENTER;case"left":return Vex.Flow.TextNote.Justification.LEFT;case"right":return Vex.Flow.TextNote.Justification.RIGHT;default:return Vex.Flow.TextNote.Justification.CENTER}}(),s=i?"b":this.current_duration,c={text:e,duration:s,smooth:r,ignore_ticks:i,font:{family:o,size:u,weight:a}},e[0]==="#"&&(c.glyph=e.slice(1)),l=(new Vex.Flow.TextNote(c)).setLine(t).setJustification(f),_.last(h).push(l)},f.prototype.addVoice=function(e){var t;this.closeBends(),t=_.last(this.staves);if(t==null)return this.addStave(e);_.isEmpty(t.tab_notes)||(t.tab_voices.push(t.tab_notes),t.tab_notes=[]);if(!_.isEmpty(t.note_notes))return t.note_voices.push(t.note_notes),t.note_notes=[]},f.prototype.addStave=function(e){var t,r,i,s;r={tuning:"standard",clef:"treble",key:"C",notation:"false",tablature:"true"},_.extend(r,e),n("addTabStave: ",e),i=null,t=null,s=40,r.notation==="true"&&(t=(new Vex.Flow.Stave(this.x,this.last_y,this.customizations.width-20)).addClef(r.clef).addKeySignature(r.key),r.time!=null&&t.addTimeSignature(r.time),this.last_y+=t.getHeight()+this.options.note_stave_lower_spacing+parseInt(this.customizations["stave-distance"],10),s=t.getNoteStartX(),this.current_clef=r.clef),r.tablature==="true"&&(i=(new Vex.Flow.TabStave(this.x,this.last_y,this.customizations.width-20)).addTabGlyph().setNoteStartX(s),this.last_y+=i.getHeight()+this.options.tab_stave_lower_spacing),this.closeBends(),this.staves.push({tab:i,note:t,tab_voices:[],note_voices:[],tab_notes:[],note_notes:[],text_voices:[]}),this.tuning.setTuning(r.tuning),this.key_manager.setKey(r.key)},f}()}).call(this);// Generated by CoffeeScript 1.4.0
(function(){var e=[].slice,t=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};Vex.Flow.VexTab=function(){function i(e){this.artist=e,this.reset()}var n,r;return i.DEBUG=!1,n=function(){var t;t=1<=arguments.length?e.call(arguments,0):[];if(Vex.Flow.VexTab.DEBUG)return typeof console!="undefined"&&console!==null?console.log.apply(console,["(Vex.Flow.VexTab)"].concat(e.call(t))):void 0},r=function(e,t){return new Vex.RERR("ParseError",""+t+" in line "+e._l+" column "+e._c)},i.prototype.reset=function(){return this.valid=!1,this.elements=!1},i.prototype.isValid=function(){return this.valid},i.prototype.parseStaveOptions=function(e){var n,i,s,o,u,a,f,l,c,h,p;u={notation:"false",tablature:"true"};if(e==null)return u;s=null;for(f=0,l=e.length;f<l;f++){o=e[f],i=function(e){return r(o,e)},u[o.key]=o.value;switch(o.key){case"notation":case"tablature":s=o;if((c=o.value)!=="true"&&c!=="false")throw i("'"+o.key+"' must be 'true' or 'false'");break;case"key":if(!_.has(Vex.Flow.keySignature.keySpecs,o.value))throw i("Invalid key signature '"+o.value+"'");break;case"clef":n=["treble","bass","tenor","alto","percussion"];if(h=o.value,t.call(n,h)<0)throw i("'clef' must be one of "+n.join(", "));break;case"voice":a=["top","bottom","new"];if(p=o.value,t.call(a,p)<0)throw i("'voice' must be one of "+a.join(", "));break;case"time":try{new Vex.Flow.TimeSignature(o.value)}catch(d){throw i("Invalid time signature: '"+o.value+"'")}break;case"tuning":try{new Vex.Flow.Tuning(o.value)}catch(d){throw i("Invalid tuning: '"+o.value+"'")}break;default:throw i("Invalid option '"+o.key+"'")}}if(u.notation==="false"&&u.tablature==="false")throw r(s,"Both 'notation' and 'tablature' can't be invisible");return u},i.prototype.parseCommand=function(e){e.command==="bar"&&this.artist.addBar(e.type),e.command==="tuplet"&&this.artist.makeTuplets(e.params.tuplet,e.params.notes),e.command==="annotations"&&this.artist.addAnnotations(e.params);if(e.command==="rest")return this.artist.addRest(e.params)},i.prototype.parseChord=function(e){return n("parseChord:",e),this.artist.addChord(_.map(e.chord,function(e){return _.pick(e,"time","dot","fret","abc","string","articulation","decorator")}),e.articulation,e.decorator)},i.prototype.parseFret=function(e){return this.artist.addNote(_.pick(e,"time","dot","fret","string","articulation","decorator"))},i.prototype.parseABC=function(e){return this.artist.addNote(_.pick(e,"time","dot","abc","string","articulation","decorator"))},i.prototype.parseStaveElements=function(e){var t,r,i,s;n("parseStaveElements:",e),s=[];for(r=0,i=e.length;r<i;r++)t=e[r],t.time&&this.artist.setDuration(t.time,t.dot),t.command&&this.parseCommand(t),t.chord&&this.parseChord(t),t.fret&&this.parseFret(t),t.abc?s.push(this.parseABC(t)):s.push(void 0);return s},i.prototype.parseStaveText=function(e){var t,n,i,s,o,u,a,f,l,c,h,p,d=this;_.isEmpty(e)||this.artist.addTextVoice(),u=0,o="center",a=!0,s=null,t=function(){return d.artist.addTextNote("",0,o,!1,!0)},i=function(e){var t;t=!1,e[0]==="|"&&(t=!0,e=e.slice(1));try{return d.artist.addTextNote(e,u,o,a,t)}catch(n){throw r(f,"Bad text or duration. Did you forget a comma?"+n)}},p=[];for(c=0,h=e.length;c<h;c++){f=e[c],l=f.text.trim();if(l.match(/\.font=.*/))s=l.slice(6),p.push(this.artist.setTextFont(s));else if(l[0]===":")p.push(this.artist.setDuration(l));else if(l[0]==="."){n=l.slice(1);switch(n){case"center":case"left":case"right":p.push(o=n);break;case"strict":p.push(a=!1);break;case"smooth":p.push(a=!0);break;case"bar":case"|":p.push(t());break;default:p.push(u=parseInt(l.slice(1),10))}}else l==="|"?p.push(t()):l.slice(0,2)==="++"?p.push(this.artist.addTextVoice()):p.push(i(l))}return p},i.prototype.generate=function(){var e,t,n,i,s,o,u,a,f,l;a=this.elements,l=[];for(i=0,o=a.length;i<o;i++){n=a[i];switch(n.element){case"stave":case"tabstave":this.artist.addStave(this.parseStaveOptions(n.options)),n.notes!=null&&this.parseStaveElements(n.notes),n.text!=null?l.push(this.parseStaveText(n.text)):l.push(void 0);break;case"voice":this.artist.addVoice(this.parseStaveOptions(n.options)),n.notes!=null&&this.parseStaveElements(n.notes),n.text!=null?l.push(this.parseStaveText(n.text)):l.push(void 0);break;case"options":t={},f=n.params;for(s=0,u=f.length;s<u;s++)e=f[s],t[e.key]=e.value;try{l.push(this.artist.setOptions(t))}catch(c){throw r(n,c.message)}break;default:throw r(n,"Invalid keyword '"+n.element+"'")}}return l},i.prototype.parse=function(e){var t,r;vextab_parser.parseError=function(e,t){throw n("VexTab parse error: ",e,t),e="Unexpected text '"+t.text+"' at line "+t.loc.first_line+" column "+t.loc.first_column+".",new Vex.RERR("ParseError",e)};if(e==null)throw new Vex.RERR("ParseError","No code");return n("Parsing:\n"+e),r=function(){var n,r,i,s;i=e.split(/\r\n|\r|\n/),s=[];for(n=0,r=i.length;n<r;n++)t=i[n],s.push(t.trim());return s}(),this.elements=vextab_parser.parse(r.join("\n")),this.elements&&(this.generate(),this.valid=!0),this.elements},i}()}).call(this);